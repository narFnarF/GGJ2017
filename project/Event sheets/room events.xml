<?xml version="1.0" encoding="utf-8" ?>
<c2eventsheet>
    <!--All the 'name' attributes are ignored by Construct 2 - they are there for readability only.-->
    <name>room events</name>
    <events>
        <include>emitter pen events</include>
        <comment>settings</comment>
        <variable constant="1" name="MAX_SECTIONs" sid="718732771441661" static="0" type="number">2</variable>
        <variable constant="1" name="MAX_INSTRUMENTS" sid="544170108094473" static="0" type="number">7</variable>
        <variable constant="1" name="MAX_VARIATIONS" sid="902463580071685" static="0" type="number">3</variable>
        <comment>tracking variables</comment>
        <variable constant="0" name="currentLevel" sid="263851105402925" static="0" type="number">1</variable>
        <variable constant="0" name="currentSection" sid="116618215899975" static="0" type="number">1</variable>
        <variable constant="0" name="currentWave" sid="609255749712654" static="0" type="number">1</variable>
        <event-group description="" sid="556006138300398" title="Controls">
            <sub-events>
                <event-block sid="352422371878316">
                    <conditions>
                        <condition id="13" name="Gamepads are supported" sid="756075863531598" type="Gamepad" />
                    </conditions>
                    <actions />
                    <sub-events>
                        <event-block sid="446055993339556">
                            <conditions>
                                <condition id="3" name="Is button down" sid="463885857640609" type="Gamepad">
                                    <param id="0" name="Gamepad">0</param>
                                    <param id="1" name="Button">14</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action behavior="8Direction" id="7" name="Simulate control" sid="889543764468734" type="player">
                                    <param id="0" name="Control">0</param>
                                </action>
                            </actions>
                        </event-block>
                        <event-block sid="562618078048580">
                            <conditions>
                                <condition id="3" name="Is button down" sid="693832929181868" type="Gamepad">
                                    <param id="0" name="Gamepad">0</param>
                                    <param id="1" name="Button">15</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action behavior="8Direction" id="7" name="Simulate control" sid="169641465802382" type="player">
                                    <param id="0" name="Control">1</param>
                                </action>
                            </actions>
                        </event-block>
                        <event-block sid="550508294855002">
                            <conditions>
                                <condition id="3" name="Is button down" sid="130829021494971" type="Gamepad">
                                    <param id="0" name="Gamepad">0</param>
                                    <param id="1" name="Button">12</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action behavior="8Direction" id="7" name="Simulate control" sid="145064240280092" type="player">
                                    <param id="0" name="Control">2</param>
                                </action>
                            </actions>
                        </event-block>
                        <event-block sid="287649817467517">
                            <conditions>
                                <condition id="3" name="Is button down" sid="115227717750801" type="Gamepad">
                                    <param id="0" name="Gamepad">0</param>
                                    <param id="1" name="Button">13</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action behavior="8Direction" id="7" name="Simulate control" sid="132548845321595" type="player">
                                    <param id="0" name="Control">3</param>
                                </action>
                            </actions>
                        </event-block>
                    </sub-events>
                </event-block>
                <event-block disabled="1" sid="304101293309318">
                    <conditions />
                    <actions>
                        <action behavior="8Direction" id="9" name="Set vector X" sid="737153041225734" type="player">
                            <param id="0" name="Vector X">Gamepad.RawAxis(0, 0)</param>
                        </action>
                    </actions>
                </event-block>
            </sub-events>
        </event-group>
        <event-group description="" sid="629028763288617" title="preparing stuff">
            <sub-events>
                <event-block sid="191493947246880">
                    <conditions>
                        <condition id="-2" name="On start of layout" sid="493973392171880" type="System" />
                    </conditions>
                    <actions>
                        <action id="26" name="Set listener object" sid="294707170655397" type="Audio">
                            <param id="0" name="Object">player</param>
                        </action>
                    </actions>
                    <sub-events>
                        <event-block sid="971711231016664">
                            <conditions>
                                <condition id="-11" name="For Each" sid="693298932039081" type="System">
                                    <param id="0" name="Object">emitter</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="-10" name="Set value" sid="558492543041072" type="emitter">
                                    <param id="0" name="Instance variable">audioTag</param>
                                    <param id="1" name="Value">emitterLabel.Text</param>
                                </action>
                            </actions>
                        </event-block>
                        <event-block sid="710034705656034">
                            <conditions />
                            <actions>
                                <action id="0" name="Call function" sid="938135749839616" type="Function">
                                    <param id="0" name="Name">&quot;destroy some emitters&quot;</param>
                                    <param id="1" name="Parameter {n}"></param>
                                </action>
                            </actions>
                        </event-block>
                        <comment>preload tout ce qui est requis pour ce level</comment>
                        <event-block sid="320644417987045">
                            <conditions>
                                <condition id="-11" name="For Each" sid="202099706428789" type="System">
                                    <param id="0" name="Object">emitter</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="9" name="Preload (by name)" sid="303243606015948" type="Audio">
                                    <param id="0" name="Folder">1</param>
                                    <param id="1" name="Audio file name">emitter.audioTag</param>
                                </action>
                                <action id="14" name="Log" sid="609212000914174" type="Browser">
                                    <param id="0" name="Type">0</param>
                                    <param id="1" name="Message">&quot;preload &quot; &amp; emitter.audioTag</param>
                                </action>
                            </actions>
                        </event-block>
                    </sub-events>
                </event-block>
                <event-block sid="658521231797683">
                    <conditions>
                        <condition id="1" name="Preloads complete" sid="255343389943841" type="Audio" />
                        <condition id="-4" name="Trigger once while true" sid="960864757838555" type="System" />
                    </conditions>
                    <actions>
                        <action id="14" name="Log" sid="899491116344913" type="Browser">
                            <param id="0" name="Type">0</param>
                            <param id="1" name="Message">&quot;preload complete&quot;</param>
                        </action>
                    </actions>
                    <sub-events>
                        <event-block sid="744351176855594">
                            <conditions>
                                <condition id="-11" name="For Each" sid="821575369087289" type="System">
                                    <param id="0" name="Object">emitter</param>
                                </condition>
                                <condition id="-7" name="Compare instance variable" sid="641222521186379" type="emitterLabel">
                                    <param id="0" name="Instance variable">section</param>
                                    <param id="1" name="Comparison">0</param>
                                    <param id="2" name="Value">currentSection</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="28" name="Play at object (by name)" sid="514877135283410" type="Audio">
                                    <param id="0" name="Folder">1</param>
                                    <param id="1" name="Audio file name">emitter.audioTag</param>
                                    <param id="2" name="Loop">1</param>
                                    <param id="3" name="Volume">0</param>
                                    <param id="4" name="Object">emitter</param>
                                    <param id="5" name="Inner angle">360</param>
                                    <param id="6" name="Outer angle">360</param>
                                    <param id="7" name="Outer gain">0</param>
                                    <param id="8" name="Tag (optional)">emitter.audioTag</param>
                                </action>
                                <action id="2" name="Set muted" sid="456009809475526" type="Audio">
                                    <param id="0" name="Tag">emitter.audioTag</param>
                                    <param id="1" name="State">0</param>
                                </action>
                            </actions>
                        </event-block>
                        <event-block sid="628756339080839">
                            <conditions />
                            <actions>
                                <action id="0" name="Call function" sid="404687085323492" type="Function">
                                    <param id="0" name="Name">&quot;spawn first emitter&quot;</param>
                                    <param id="1" name="Parameter {n}"></param>
                                </action>
                            </actions>
                        </event-block>
                    </sub-events>
                </event-block>
                <event-block sid="414250334468446">
                    <conditions>
                        <condition id="0" name="On function" sid="558283363448159" type="Function">
                            <param id="0" name="Name">&quot;destroy some emitters&quot;</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="14" name="Log" sid="463397322120380" type="Browser">
                            <param id="0" name="Type">0</param>
                            <param id="1" name="Message">&quot;randomly destroy some&quot;</param>
                        </action>
                    </actions>
                    <sub-events>
                        <comment>destroy all those of other levels</comment>
                        <event-block sid="853529172560538">
                            <conditions>
                                <condition id="-7" name="Compare instance variable" sid="529029881807573" type="emitterLabel">
                                    <param id="0" name="Instance variable">level</param>
                                    <param id="1" name="Comparison">1</param>
                                    <param id="2" name="Value">currentLevel</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="-9" name="Destroy" sid="597335139229036" type="emitter" />
                            </actions>
                        </event-block>
                        <comment>Randomly destroy 1 variation per instrument per section</comment>
                        <event-block sid="790153827877980">
                            <conditions>
                                <condition id="-10" name="For" sid="315289211210471" type="System">
                                    <param id="0" name="Name">&quot;sections&quot;</param>
                                    <param id="1" name="Start index">1</param>
                                    <param id="2" name="End index">Function.Call(&quot;max sections&quot;, currentLevel)</param>
                                </condition>
                            </conditions>
                            <actions />
                            <sub-events>
                                <event-block sid="930830184339769">
                                    <conditions>
                                        <condition id="-10" name="For" sid="136793510213653" type="System">
                                            <param id="0" name="Name">&quot;instruments&quot;</param>
                                            <param id="1" name="Start index">1</param>
                                            <param id="2" name="End index">Function.Call(&quot;max instruments&quot;, currentLevel, loopindex(&quot;sections&quot;))</param>
                                        </condition>
                                    </conditions>
                                    <actions>
                                        <action id="14" name="Log" sid="627939605367927" type="Browser">
                                            <param id="0" name="Type">0</param>
                                            <param id="1" name="Message">&quot;section &quot; &amp; loopindex(&quot;sections&quot;) &amp; &quot;  instrument &quot; &amp; loopindex(&quot;instruments&quot;)</param>
                                        </action>
                                    </actions>
                                    <sub-events>
                                        <event-block sid="614779815190049">
                                            <conditions>
                                                <condition id="-7" name="Compare instance variable" sid="643901261265329" type="emitterLabel">
                                                    <param id="0" name="Instance variable">section</param>
                                                    <param id="1" name="Comparison">0</param>
                                                    <param id="2" name="Value">loopindex(&quot;sections&quot;)</param>
                                                </condition>
                                                <condition id="-7" name="Compare instance variable" sid="398063711183859" type="emitterLabel">
                                                    <param id="0" name="Instance variable">instrument</param>
                                                    <param id="1" name="Comparison">0</param>
                                                    <param id="2" name="Value">loopindex(&quot;instruments&quot;)</param>
                                                </condition>
                                                <condition id="-16" name="Pick random instance" sid="594657511882388" type="System">
                                                    <param id="0" name="Object">emitter</param>
                                                </condition>
                                            </conditions>
                                            <actions>
                                                <action id="-9" name="Destroy" sid="844368392696821" type="emitter" />
                                            </actions>
                                        </event-block>
                                    </sub-events>
                                </event-block>
                            </sub-events>
                        </event-block>
                    </sub-events>
                </event-block>
            </sub-events>
        </event-group>
        <event-group description="" sid="168705400442144" title="collisions &amp; attach &amp; destroy &amp; stop audio">
            <sub-events>
                <variable constant="0" name="collidedInstrument" sid="415592084256187" static="0" type="number">0</variable>
                <variable constant="0" name="collidedUID" sid="888406868354815" static="0" type="number">0</variable>
                <comment>Emitter picked up!</comment>
                <comment>Remember: On collision is triggered only ONCE!</comment>
                <event-block sid="316617317847663">
                    <conditions>
                        <condition id="0" name="On collision with another object" sid="515521823437352" type="player">
                            <param id="0" name="Object">emitter</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="14" name="Log" sid="569452555593171" type="Browser">
                            <param id="0" name="Type">0</param>
                            <param id="1" name="Message">&quot;got one!&quot;</param>
                        </action>
                        <action id="-4" name="Set position to another object" sid="771411248004055" type="emitter">
                            <param id="0" name="Object">player</param>
                            <param id="1" name="Image point (optional)">0</param>
                        </action>
                        <action behavior="Pin" id="0" name="Pin to object" sid="464729415974102" type="emitter">
                            <param id="0" name="Pin to">player</param>
                            <param id="1" name="Mode">1</param>
                        </action>
                        <action id="0" name="Play" sid="392265650804152" type="Audio">
                            <param id="0" name="Audio file">Pickup</param>
                            <param id="2" name="Loop">0</param>
                            <param id="3" name="Volume">-10</param>
                            <param id="1" name="Tag (optional)">&quot;pickup&quot;</param>
                        </action>
                        <action id="3" name="Set volume" sid="933864095258586" type="Audio">
                            <param id="0" name="Tag">emitter.audioTag</param>
                            <param id="1" name="dB">-15</param>
                        </action>
                        <action id="-9" name="Set value" sid="807805727247375" type="System">
                            <param id="0" name="Variable">collidedInstrument</param>
                            <param id="1" name="Value">emitterLabel.instrument</param>
                        </action>
                        <action id="-9" name="Set value" sid="796010427234148" type="System">
                            <param id="0" name="Variable">collidedUID</param>
                            <param id="1" name="Value">emitter.UID</param>
                        </action>
                        <action id="-13" name="Set boolean" sid="769508810740586" type="emitter">
                            <param id="0" name="Instance variable">picked</param>
                            <param id="1" name="Value">1</param>
                        </action>
                    </actions>
                    <sub-events>
                        <comment>Destroy all other emitter of the same instrument (in the current section), because we don&apos;t want to randomly pick them ever again</comment>
                        <event-block sid="249677403569606">
                            <conditions>
                                <condition id="-19" name="Pick all" sid="297834658029715" type="System">
                                    <param id="0" name="Object">emitter</param>
                                </condition>
                                <condition id="-14" inverted="1" name="Pick by unique ID" sid="709653980534869" type="emitter">
                                    <param id="0" name="Unique ID">collidedUID</param>
                                </condition>
                                <condition id="-7" name="Compare instance variable" sid="563458991961523" type="emitterLabel">
                                    <param id="0" name="Instance variable">section</param>
                                    <param id="1" name="Comparison">0</param>
                                    <param id="2" name="Value">currentSection</param>
                                </condition>
                                <condition id="-7" name="Compare instance variable" sid="664731384231590" type="emitterLabel">
                                    <param id="0" name="Instance variable">instrument</param>
                                    <param id="1" name="Comparison">0</param>
                                    <param id="2" name="Value">collidedInstrument</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="-9" name="Destroy" sid="764911017258393" type="emitter" />
                            </actions>
                        </event-block>
                        <comment>Destroy the non-picked emitter</comment>
                        <event-block sid="475461656207505">
                            <conditions>
                                <condition id="-19" name="Pick all" sid="281035015895098" type="System">
                                    <param id="0" name="Object">emitter</param>
                                </condition>
                                <condition id="-8" name="Is boolean instance variable set" sid="705165467485919" type="emitter">
                                    <param id="0" name="Instance variable">active</param>
                                </condition>
                                <condition id="1" inverted="1" name="Is overlapping another object" sid="718319769808438" type="emitter">
                                    <param id="0" name="Object">player</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="-9" name="Destroy" sid="259018630203354" type="emitter" />
                            </actions>
                        </event-block>
                        <event-block sid="952054240373380">
                            <conditions />
                            <actions>
                                <action disabled="1" id="11" name="Set collisions enabled" sid="715852093403407" type="emitter">
                                    <param id="0" name="Collisions">0</param>
                                </action>
                            </actions>
                        </event-block>
                        <event-block sid="211026577087959">
                            <conditions />
                            <actions>
                                <action id="-16" name="Wait" sid="981806724743713" type="System">
                                    <param id="0" name="Seconds">2</param>
                                </action>
                                <action id="0" name="Call function" sid="276755266456660" type="Function">
                                    <param id="0" name="Name">&quot;advance wave&quot;</param>
                                    <param id="1" name="Parameter {n}"></param>
                                </action>
                            </actions>
                        </event-block>
                    </sub-events>
                </event-block>
                <event-block sid="250561156914325">
                    <conditions>
                        <condition id="-19" name="On destroyed" sid="315049947018790" type="emitter" />
                    </conditions>
                    <actions>
                        <action id="6" name="Stop" sid="594103173910800" type="Audio">
                            <param id="0" name="Tag">emitter.audioTag</param>
                        </action>
                    </actions>
                </event-block>
            </sub-events>
        </event-group>
        <event-group description="" sid="981682486005776" title="walls">
            <sub-events>
                <variable constant="0" name="xDistance" sid="104086270663331" static="0" type="number">550</variable>
                <variable constant="0" name="yDistance" sid="686734392075183" static="0" type="number">550</variable>
                <event-block sid="882858363464582">
                    <conditions>
                        <condition id="0" name="On function" sid="517262043750257" type="Function">
                            <param id="0" name="Name">&quot;walls .replaceWalls&quot;</param>
                        </condition>
                    </conditions>
                    <actions />
                    <sub-events>
                        <event-block sid="848000744856004">
                            <conditions>
                                <condition id="-7" name="Compare instance variable" sid="235654751372685" type="wall">
                                    <param id="0" name="Instance variable">which</param>
                                    <param id="1" name="Comparison">0</param>
                                    <param id="2" name="Value">&quot;top&quot;</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="-3" name="Set position" sid="744383458453098" type="wall">
                                    <param id="0" name="X">player.X</param>
                                    <param id="1" name="Y">player.Y - yDistance</param>
                                </action>
                            </actions>
                        </event-block>
                        <event-block sid="745660294822169">
                            <conditions>
                                <condition id="-7" name="Compare instance variable" sid="383116778003629" type="wall">
                                    <param id="0" name="Instance variable">which</param>
                                    <param id="1" name="Comparison">0</param>
                                    <param id="2" name="Value">&quot;bot&quot;</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="-3" name="Set position" sid="267613612493636" type="wall">
                                    <param id="0" name="X">player.X</param>
                                    <param id="1" name="Y">player.Y + yDistance</param>
                                </action>
                            </actions>
                        </event-block>
                        <event-block sid="899496924526826">
                            <conditions>
                                <condition id="-7" name="Compare instance variable" sid="360568469236212" type="wall">
                                    <param id="0" name="Instance variable">which</param>
                                    <param id="1" name="Comparison">0</param>
                                    <param id="2" name="Value">&quot;left&quot;</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="-3" name="Set position" sid="699801463003797" type="wall">
                                    <param id="0" name="X">player.X - xDistance</param>
                                    <param id="1" name="Y">player.Y</param>
                                </action>
                            </actions>
                        </event-block>
                        <event-block sid="147070798660467">
                            <conditions>
                                <condition id="-7" name="Compare instance variable" sid="979182573389975" type="wall">
                                    <param id="0" name="Instance variable">which</param>
                                    <param id="1" name="Comparison">0</param>
                                    <param id="2" name="Value">&quot;right&quot;</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="-3" name="Set position" sid="322908276292968" type="wall">
                                    <param id="0" name="X">player.X + xDistance</param>
                                    <param id="1" name="Y">player.Y</param>
                                </action>
                            </actions>
                        </event-block>
                    </sub-events>
                </event-block>
                <comment>bump sfx</comment>
                <event-block sid="694959145938549">
                    <conditions>
                        <condition id="-6" name="Every X seconds" sid="238015815158590" type="System">
                            <param id="0" name="Interval (seconds)">0.2</param>
                        </condition>
                    </conditions>
                    <actions />
                    <sub-events>
                        <event-block any="1" sid="700274975369937">
                            <conditions>
                                <condition id="2" name="Key is down" sid="281168774061271" type="Keyboard">
                                    <param id="0" name="Key">38 (Up arrow)</param>
                                </condition>
                                <condition id="3" name="Is button down" sid="125994485625230" type="Gamepad">
                                    <param id="0" name="Gamepad">0</param>
                                    <param id="1" name="Button">12</param>
                                </condition>
                            </conditions>
                            <actions />
                            <sub-events>
                                <event-block sid="952054879457699">
                                    <conditions>
                                        <condition id="-7" name="Compare instance variable" sid="445869303620008" type="wall">
                                            <param id="0" name="Instance variable">which</param>
                                            <param id="1" name="Comparison">0</param>
                                            <param id="2" name="Value">&quot;top&quot;</param>
                                        </condition>
                                        <condition id="9" name="Is overlapping at offset" sid="552834330890745" type="player">
                                            <param id="0" name="Object">wall</param>
                                            <param id="1" name="Offset X">0</param>
                                            <param id="2" name="Offset Y">-10</param>
                                        </condition>
                                    </conditions>
                                    <actions>
                                        <action disabled="1" id="14" name="Log" sid="856354694941029" type="Browser">
                                            <param id="0" name="Type">1</param>
                                            <param id="1" name="Message">&quot;bump&quot;</param>
                                        </action>
                                        <action disabled="1" id="0" name="Play" sid="956247140526255" type="Audio">
                                            <param id="0" name="Audio file">bump</param>
                                            <param id="2" name="Loop">0</param>
                                            <param id="3" name="Volume">0</param>
                                            <param id="1" name="Tag (optional)">&quot;bump&quot;</param>
                                        </action>
                                        <action id="24" name="Play at position" sid="389838768772116" type="Audio">
                                            <param id="0" name="Audio file">bump</param>
                                            <param id="1" name="Loop">0</param>
                                            <param id="2" name="Volume">0</param>
                                            <param id="3" name="X">player.X</param>
                                            <param id="4" name="Y">player.Y -20</param>
                                            <param id="5" name="Angle">0</param>
                                            <param id="6" name="Inner angle">360</param>
                                            <param id="7" name="Outer angle">360</param>
                                            <param id="8" name="Outer gain">0</param>
                                            <param id="9" name="Tag (optional)">&quot;bump&quot;</param>
                                        </action>
                                    </actions>
                                </event-block>
                            </sub-events>
                        </event-block>
                        <event-block any="1" sid="540929920375785">
                            <conditions>
                                <condition id="2" name="Key is down" sid="629304719192625" type="Keyboard">
                                    <param id="0" name="Key">40 (Down arrow)</param>
                                </condition>
                                <condition id="3" name="Is button down" sid="824638689574263" type="Gamepad">
                                    <param id="0" name="Gamepad">0</param>
                                    <param id="1" name="Button">13</param>
                                </condition>
                            </conditions>
                            <actions />
                            <sub-events>
                                <event-block sid="759739517666885">
                                    <conditions>
                                        <condition id="-7" name="Compare instance variable" sid="405499263101521" type="wall">
                                            <param id="0" name="Instance variable">which</param>
                                            <param id="1" name="Comparison">0</param>
                                            <param id="2" name="Value">&quot;bot&quot;</param>
                                        </condition>
                                        <condition id="9" name="Is overlapping at offset" sid="594593864099296" type="player">
                                            <param id="0" name="Object">wall</param>
                                            <param id="1" name="Offset X">0</param>
                                            <param id="2" name="Offset Y">10</param>
                                        </condition>
                                    </conditions>
                                    <actions>
                                        <action disabled="1" id="14" name="Log" sid="531671367922958" type="Browser">
                                            <param id="0" name="Type">1</param>
                                            <param id="1" name="Message">&quot;bump&quot;</param>
                                        </action>
                                        <action disabled="1" id="0" name="Play" sid="463818737350688" type="Audio">
                                            <param id="0" name="Audio file">bump</param>
                                            <param id="2" name="Loop">0</param>
                                            <param id="3" name="Volume">0</param>
                                            <param id="1" name="Tag (optional)">&quot;bump&quot;</param>
                                        </action>
                                        <action id="24" name="Play at position" sid="417261174021891" type="Audio">
                                            <param id="0" name="Audio file">bump</param>
                                            <param id="1" name="Loop">0</param>
                                            <param id="2" name="Volume">0</param>
                                            <param id="3" name="X">player.X</param>
                                            <param id="4" name="Y">player.Y +20</param>
                                            <param id="5" name="Angle">0</param>
                                            <param id="6" name="Inner angle">360</param>
                                            <param id="7" name="Outer angle">360</param>
                                            <param id="8" name="Outer gain">0</param>
                                            <param id="9" name="Tag (optional)">&quot;bump&quot;</param>
                                        </action>
                                    </actions>
                                </event-block>
                            </sub-events>
                        </event-block>
                        <event-block any="1" sid="722659545266718">
                            <conditions>
                                <condition id="2" name="Key is down" sid="968037803345873" type="Keyboard">
                                    <param id="0" name="Key">37 (Left arrow)</param>
                                </condition>
                                <condition id="3" name="Is button down" sid="280900967978901" type="Gamepad">
                                    <param id="0" name="Gamepad">0</param>
                                    <param id="1" name="Button">14</param>
                                </condition>
                            </conditions>
                            <actions />
                            <sub-events>
                                <event-block sid="526355404534105">
                                    <conditions>
                                        <condition id="-7" name="Compare instance variable" sid="606256300593425" type="wall">
                                            <param id="0" name="Instance variable">which</param>
                                            <param id="1" name="Comparison">0</param>
                                            <param id="2" name="Value">&quot;left&quot;</param>
                                        </condition>
                                        <condition id="9" name="Is overlapping at offset" sid="206170890736483" type="player">
                                            <param id="0" name="Object">wall</param>
                                            <param id="1" name="Offset X">-10</param>
                                            <param id="2" name="Offset Y">0</param>
                                        </condition>
                                    </conditions>
                                    <actions>
                                        <action disabled="1" id="14" name="Log" sid="607319657939833" type="Browser">
                                            <param id="0" name="Type">1</param>
                                            <param id="1" name="Message">&quot;bump&quot;</param>
                                        </action>
                                        <action id="24" name="Play at position" sid="117852498871375" type="Audio">
                                            <param id="0" name="Audio file">bump</param>
                                            <param id="1" name="Loop">0</param>
                                            <param id="2" name="Volume">0</param>
                                            <param id="3" name="X">player.X -20</param>
                                            <param id="4" name="Y">player.Y</param>
                                            <param id="5" name="Angle">0</param>
                                            <param id="6" name="Inner angle">360</param>
                                            <param id="7" name="Outer angle">360</param>
                                            <param id="8" name="Outer gain">0</param>
                                            <param id="9" name="Tag (optional)">&quot;bump&quot;</param>
                                        </action>
                                    </actions>
                                </event-block>
                            </sub-events>
                        </event-block>
                        <event-block any="1" sid="291200009332321">
                            <conditions>
                                <condition id="2" name="Key is down" sid="392926544380632" type="Keyboard">
                                    <param id="0" name="Key">39 (Right arrow)</param>
                                </condition>
                                <condition id="3" name="Is button down" sid="648609428015380" type="Gamepad">
                                    <param id="0" name="Gamepad">0</param>
                                    <param id="1" name="Button">15</param>
                                </condition>
                            </conditions>
                            <actions />
                            <sub-events>
                                <event-block sid="565629081506548">
                                    <conditions>
                                        <condition id="-7" name="Compare instance variable" sid="248428691595569" type="wall">
                                            <param id="0" name="Instance variable">which</param>
                                            <param id="1" name="Comparison">0</param>
                                            <param id="2" name="Value">&quot;right&quot;</param>
                                        </condition>
                                        <condition id="9" name="Is overlapping at offset" sid="620991021966084" type="player">
                                            <param id="0" name="Object">wall</param>
                                            <param id="1" name="Offset X">10</param>
                                            <param id="2" name="Offset Y">0</param>
                                        </condition>
                                    </conditions>
                                    <actions>
                                        <action disabled="1" id="14" name="Log" sid="673513033541145" type="Browser">
                                            <param id="0" name="Type">1</param>
                                            <param id="1" name="Message">&quot;bump&quot;</param>
                                        </action>
                                        <action id="24" name="Play at position" sid="673878202386361" type="Audio">
                                            <param id="0" name="Audio file">bump</param>
                                            <param id="1" name="Loop">0</param>
                                            <param id="2" name="Volume">0</param>
                                            <param id="3" name="X">player.X +20</param>
                                            <param id="4" name="Y">player.Y</param>
                                            <param id="5" name="Angle">0</param>
                                            <param id="6" name="Inner angle">360</param>
                                            <param id="7" name="Outer angle">360</param>
                                            <param id="8" name="Outer gain">0</param>
                                            <param id="9" name="Tag (optional)">&quot;bump&quot;</param>
                                        </action>
                                    </actions>
                                </event-block>
                            </sub-events>
                        </event-block>
                    </sub-events>
                </event-block>
                <event-block sid="470986546765631">
                    <conditions>
                        <condition id="-2" name="On start of layout" sid="324868324810088" type="System" />
                    </conditions>
                    <actions>
                        <action id="0" name="Call function" sid="520002882846927" type="Function">
                            <param id="0" name="Name">&quot;walls .replaceWalls&quot;</param>
                            <param id="1" name="Parameter {n}"></param>
                        </action>
                    </actions>
                </event-block>
            </sub-events>
        </event-group>
        <event-group description="" sid="279352294193933" title="flow">
            <sub-events>
                <event-block sid="931847693269505">
                    <conditions>
                        <condition id="0" name="On function" sid="514513896689731" type="Function">
                            <param id="0" name="Name">&quot;advance wave&quot;</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="-10" name="Add to" sid="961427690886073" type="System">
                            <param id="0" name="Variable">currentWave</param>
                            <param id="1" name="Value">1</param>
                        </action>
                        <action id="14" name="Log" sid="565059735996765" type="Browser">
                            <param id="0" name="Type">0</param>
                            <param id="1" name="Message">&quot;Entering wave &quot; &amp; currentWave</param>
                        </action>
                        <action id="0" name="Call function" sid="568601536145387" type="Function">
                            <param id="0" name="Name">&quot;walls .replaceWalls&quot;</param>
                            <param id="1" name="Parameter {n}"></param>
                        </action>
                    </actions>
                    <sub-events>
                        <event-block sid="746312175863791">
                            <conditions>
                                <condition id="-14" name="Compare variable" sid="142919076191203" type="System">
                                    <param id="0" name="Variable">currentWave</param>
                                    <param id="1" name="Comparison">3</param>
                                    <param id="2" name="Value">4</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="0" name="Call function" sid="509154015480482" type="Function">
                                    <param id="0" name="Name">&quot;spawn 2 emitters&quot;</param>
                                    <param id="1" name="Parameter {n}"></param>
                                </action>
                            </actions>
                        </event-block>
                        <comment>after 4 pickup, go to bridge</comment>
                        <event-block sid="192150111637892">
                            <conditions>
                                <condition id="-22" name="Else" sid="291643114684338" type="System" />
                                <condition id="-14" name="Compare variable" sid="167721946201765" type="System">
                                    <param id="0" name="Variable">currentWave</param>
                                    <param id="1" name="Comparison">4</param>
                                    <param id="2" name="Value">4</param>
                                </condition>
                                <condition id="-14" name="Compare variable" sid="199521872738681" type="System">
                                    <param id="0" name="Variable">currentSection</param>
                                    <param id="1" name="Comparison">0</param>
                                    <param id="2" name="Value">1</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="0" name="Call function" sid="852914512152502" type="Function">
                                    <param id="0" name="Name">&quot;bridge&quot;</param>
                                    <param id="1" name="Parameter {n}"></param>
                                </action>
                            </actions>
                        </event-block>
                        <comment>la fin</comment>
                        <event-block sid="828204740661960">
                            <conditions>
                                <condition id="-22" name="Else" sid="180662451904469" type="System" />
                                <condition id="-14" name="Compare variable" sid="802292818929885" type="System">
                                    <param id="0" name="Variable">currentSection</param>
                                    <param id="1" name="Comparison">0</param>
                                    <param id="2" name="Value">2</param>
                                </condition>
                                <condition id="-14" name="Compare variable" sid="650650744122563" type="System">
                                    <param id="0" name="Variable">currentWave</param>
                                    <param id="1" name="Comparison">4</param>
                                    <param id="2" name="Value">4</param>
                                </condition>
                            </conditions>
                            <actions />
                        </event-block>
                    </sub-events>
                </event-block>
                <event-block sid="284693592774187">
                    <conditions>
                        <condition id="0" name="On function" sid="186178203259564" type="Function">
                            <param id="0" name="Name">&quot;spawn first emitter&quot;</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="14" name="Log" sid="402465423265422" type="Browser">
                            <param id="0" name="Type">0</param>
                            <param id="1" name="Message">&quot;function Spawn 1st&quot;</param>
                        </action>
                    </actions>
                    <sub-events>
                        <variable constant="0" name="varX" sid="136279378594740" static="0" type="number">300</variable>
                        <variable constant="0" name="varY" sid="555240108102543" static="0" type="number">400</variable>
                        <event-block sid="562684034166768">
                            <conditions>
                                <condition id="-7" name="Compare instance variable" sid="380468454650423" type="emitterLabel">
                                    <param id="0" name="Instance variable">section</param>
                                    <param id="1" name="Comparison">0</param>
                                    <param id="2" name="Value">1</param>
                                </condition>
                                <condition id="-7" name="Compare instance variable" sid="160659150854903" type="emitterLabel">
                                    <param id="0" name="Instance variable">instrument</param>
                                    <param id="1" name="Comparison">0</param>
                                    <param id="2" name="Value">1</param>
                                </condition>
                                <condition id="-16" name="Pick random instance" sid="945757332259127" type="System">
                                    <param id="0" name="Object">emitter</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="-3" name="Set position" sid="745187589368315" type="emitter">
                                    <param id="0" name="X">player.X + varX</param>
                                    <param id="1" name="Y">player.Y + varY</param>
                                </action>
                                <action id="-13" name="Set boolean" sid="961037387660009" type="emitter">
                                    <param id="0" name="Instance variable">active</param>
                                    <param id="1" name="Value">1</param>
                                </action>
                                <action id="-13" name="Set boolean" sid="620041709584763" type="emitter">
                                    <param id="0" name="Instance variable">solo</param>
                                    <param id="1" name="Value">1</param>
                                </action>
                                <action id="2" name="Set muted" sid="396630798726620" type="Audio">
                                    <param id="0" name="Tag">emitter.audioTag</param>
                                    <param id="1" name="State">1</param>
                                </action>
                            </actions>
                        </event-block>
                    </sub-events>
                </event-block>
                <event-block sid="368389885695218">
                    <conditions>
                        <condition id="0" name="On function" sid="809972090434340" type="Function">
                            <param id="0" name="Name">&quot;spawn 2 emitters&quot;</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="14" name="Log" sid="162789364120983" type="Browser">
                            <param id="0" name="Type">0</param>
                            <param id="1" name="Message">&quot;function Spawn 2&quot;</param>
                        </action>
                    </actions>
                    <sub-events>
                        <variable constant="0" name="varX" sid="959255289035880" static="0" type="number">300</variable>
                        <variable constant="0" name="varY" sid="216209310846405" static="0" type="number">200</variable>
                        <variable constant="0" name="firstInstrument" sid="391598099987897" static="0" type="number">0</variable>
                        <comment>first</comment>
                        <event-block sid="800923777503827">
                            <conditions>
                                <condition id="-7" name="Compare instance variable" sid="944455042961573" type="emitterLabel">
                                    <param id="0" name="Instance variable">section</param>
                                    <param id="1" name="Comparison">0</param>
                                    <param id="2" name="Value">currentSection</param>
                                </condition>
                                <condition id="-8" inverted="1" name="Is boolean instance variable set" sid="284729542909060" type="emitter">
                                    <param id="0" name="Instance variable">picked</param>
                                </condition>
                                <condition disabled="1" id="-7" name="Compare instance variable" sid="974689562236211" type="emitterLabel">
                                    <param id="0" name="Instance variable">section</param>
                                    <param id="1" name="Comparison">0</param>
                                    <param id="2" name="Value">choose(4, 5, 6, 7)</param>
                                </condition>
                                <condition disabled="1" id="-7" name="Compare instance variable" sid="554173482734260" type="emitterLabel">
                                    <param id="0" name="Instance variable">variation</param>
                                    <param id="1" name="Comparison">0</param>
                                    <param id="2" name="Value">1</param>
                                </condition>
                                <condition id="-16" name="Pick random instance" sid="423623094431670" type="System">
                                    <param id="0" name="Object">emitter</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="14" name="Log" sid="965701020652541" type="Browser">
                                    <param id="0" name="Type">0</param>
                                    <param id="1" name="Message">&quot;first&quot;</param>
                                </action>
                                <action id="-3" name="Set position" sid="479928485057722" type="emitter">
                                    <param id="0" name="X">player.X - varX</param>
                                    <param id="1" name="Y">player.Y - varY</param>
                                </action>
                                <action id="-13" name="Set boolean" sid="471503528016105" type="emitter">
                                    <param id="0" name="Instance variable">active</param>
                                    <param id="1" name="Value">1</param>
                                </action>
                                <action id="2" name="Set muted" sid="869581084233875" type="Audio">
                                    <param id="0" name="Tag">emitter.audioTag</param>
                                    <param id="1" name="State">1</param>
                                </action>
                                <action id="-9" name="Set value" sid="734373937217012" type="System">
                                    <param id="0" name="Variable">firstInstrument</param>
                                    <param id="1" name="Value">emitterLabel.instrument</param>
                                </action>
                            </actions>
                        </event-block>
                        <comment>second</comment>
                        <event-block sid="100580200500409">
                            <conditions>
                                <condition id="-7" name="Compare instance variable" sid="119980096944292" type="emitterLabel">
                                    <param id="0" name="Instance variable">section</param>
                                    <param id="1" name="Comparison">0</param>
                                    <param id="2" name="Value">currentSection</param>
                                </condition>
                                <condition id="-7" name="Compare instance variable" sid="904667010134808" type="emitterLabel">
                                    <param id="0" name="Instance variable">instrument</param>
                                    <param id="1" name="Comparison">1</param>
                                    <param id="2" name="Value">firstInstrument</param>
                                </condition>
                                <condition id="-8" inverted="1" name="Is boolean instance variable set" sid="481377450528235" type="emitter">
                                    <param id="0" name="Instance variable">picked</param>
                                </condition>
                                <condition id="-16" name="Pick random instance" sid="427298739553031" type="System">
                                    <param id="0" name="Object">emitter</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="14" name="Log" sid="610530440925204" type="Browser">
                                    <param id="0" name="Type">0</param>
                                    <param id="1" name="Message">&quot;second&quot;</param>
                                </action>
                                <action id="-3" name="Set position" sid="236186676108766" type="emitter">
                                    <param id="0" name="X">player.X + varX</param>
                                    <param id="1" name="Y">player.Y - varY</param>
                                </action>
                                <action id="-13" name="Set boolean" sid="972218124633859" type="emitter">
                                    <param id="0" name="Instance variable">active</param>
                                    <param id="1" name="Value">1</param>
                                </action>
                                <action id="2" name="Set muted" sid="189398654736755" type="Audio">
                                    <param id="0" name="Tag">emitter.audioTag</param>
                                    <param id="1" name="State">1</param>
                                </action>
                            </actions>
                        </event-block>
                        <event-block disabled="1" sid="486532933909819">
                            <conditions>
                                <condition id="-7" name="Compare instance variable" sid="385655609424639" type="emitterLabel">
                                    <param id="0" name="Instance variable">section</param>
                                    <param id="1" name="Comparison">0</param>
                                    <param id="2" name="Value">1</param>
                                </condition>
                                <condition id="-7" name="Compare instance variable" sid="372720756067880" type="emitterLabel">
                                    <param id="0" name="Instance variable">instrument</param>
                                    <param id="1" name="Comparison">0</param>
                                    <param id="2" name="Value">5</param>
                                </condition>
                                <condition id="-7" name="Compare instance variable" sid="306585789069788" type="emitterLabel">
                                    <param id="0" name="Instance variable">variation</param>
                                    <param id="1" name="Comparison">0</param>
                                    <param id="2" name="Value">1</param>
                                </condition>
                            </conditions>
                            <actions />
                        </event-block>
                    </sub-events>
                </event-block>
                <event-block sid="826769188528287">
                    <conditions>
                        <condition id="0" name="On function" sid="299566389002802" type="Function">
                            <param id="0" name="Name">&quot;bridge&quot;</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="-9" name="Set value" sid="450681454537300" type="System">
                            <param id="0" name="Variable">currentSection</param>
                            <param id="1" name="Value">2</param>
                        </action>
                        <action id="-9" name="Set value" sid="744101231948239" type="System">
                            <param id="0" name="Variable">currentWave</param>
                            <param id="1" name="Value">1</param>
                        </action>
                        <action id="0" name="Play" sid="514651401203410" type="Audio">
                            <param id="0" name="Audio file">Kick-TiSh_01-01</param>
                            <param id="2" name="Loop">0</param>
                            <param id="3" name="Volume">0</param>
                            <param id="1" name="Tag (optional)">&quot;bridge&quot;</param>
                        </action>
                    </actions>
                    <sub-events>
                        <event-block sid="924697045423823">
                            <conditions>
                                <condition id="-11" name="For Each" sid="233892057308036" type="System">
                                    <param id="0" name="Object">emitter</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="2" name="Set muted" sid="780445367947825" type="Audio">
                                    <param id="0" name="Tag">emitter.audioTag</param>
                                    <param id="1" name="State">0</param>
                                </action>
                            </actions>
                            <sub-events>
                                <event-block sid="167934274724306">
                                    <conditions>
                                        <condition id="-7" name="Compare instance variable" sid="499514006414226" type="emitterLabel">
                                            <param id="0" name="Instance variable">section</param>
                                            <param id="1" name="Comparison">2</param>
                                            <param id="2" name="Value">currentSection</param>
                                        </condition>
                                    </conditions>
                                    <actions>
                                        <action id="-9" name="Destroy" sid="344398653723939" type="emitter" />
                                    </actions>
                                </event-block>
                            </sub-events>
                        </event-block>
                    </sub-events>
                </event-block>
                <event-block sid="470164324230804">
                    <conditions>
                        <condition id="0" name="On ended" sid="210310713186796" type="Audio">
                            <param id="0" name="Tag">&quot;bridge&quot;</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action disabled="1" id="0" name="Call function" sid="981035364702624" type="Function">
                            <param id="0" name="Name">&quot;resync all track&quot;</param>
                            <param id="1" name="Parameter {n}"></param>
                        </action>
                        <action id="14" name="Log" sid="595241227571872" type="Browser">
                            <param id="0" name="Type">0</param>
                            <param id="1" name="Message">&quot;bridge ended&quot;</param>
                        </action>
                    </actions>
                </event-block>
            </sub-events>
        </event-group>
        <event-group description="" sid="565116506650277" title="scheduler">
            <sub-events>
                <variable comment="1=true" constant="0" name="scheduledResync" sid="621835892565677" static="1" type="number">0</variable>
                <comment>to schedule something to happen at the next restart of loop</comment>
                <event-block sid="139549657218151">
                    <conditions>
                        <condition id="0" name="On function" sid="877642171373670" type="Function">
                            <param id="0" name="Name">&quot;schedule&quot;</param>
                        </condition>
                    </conditions>
                    <actions />
                    <sub-events>
                        <variable constant="0" name="what" sid="874845271440354" static="0" type="text"></variable>
                        <event-block sid="219045279025566">
                            <conditions />
                            <actions>
                                <action id="-9" name="Set value" sid="964355515981592" type="System">
                                    <param id="0" name="Variable">what</param>
                                    <param id="1" name="Value">Function.Param(0)</param>
                                </action>
                            </actions>
                        </event-block>
                        <event-block sid="135537288469119">
                            <conditions>
                                <condition id="-14" name="Compare variable" sid="916571019414039" type="System">
                                    <param id="0" name="Variable">what</param>
                                    <param id="1" name="Comparison">0</param>
                                    <param id="2" name="Value">&quot;resync&quot;</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="-9" name="Set value" sid="363824157129886" type="System">
                                    <param id="0" name="Variable">scheduledResync</param>
                                    <param id="1" name="Value">1</param>
                                </action>
                                <action id="14" name="Log" sid="661192023748894" type="Browser">
                                    <param id="0" name="Type">0</param>
                                    <param id="1" name="Message">&quot;scheduled a resync&quot;</param>
                                </action>
                            </actions>
                        </event-block>
                        <event-block sid="440702757763493">
                            <conditions>
                                <condition id="-22" name="Else" sid="355980066173892" type="System" />
                                <condition id="-14" name="Compare variable" sid="703405156350150" type="System">
                                    <param id="0" name="Variable">what</param>
                                    <param id="1" name="Comparison">0</param>
                                    <param id="2" name="Value">&quot;bridge&quot;</param>
                                </condition>
                            </conditions>
                            <actions />
                        </event-block>
                        <event-block sid="869532109861389">
                            <conditions>
                                <condition id="-22" name="Else" sid="498341104800317" type="System" />
                                <condition id="-14" name="Compare variable" sid="857693208267878" type="System">
                                    <param id="0" name="Variable">what</param>
                                    <param id="1" name="Comparison">0</param>
                                    <param id="2" name="Value">&quot;next section&quot;</param>
                                </condition>
                            </conditions>
                            <actions />
                        </event-block>
                    </sub-events>
                </event-block>
                <comment>At end of a loop</comment>
                <comment>TO DO : separate in 2 function: the check for a resync &amp; the loop restart function</comment>
                <event-block sid="278820410427462">
                    <conditions>
                        <condition id="0" name="On function" sid="887435978693490" type="Function">
                            <param id="0" name="Name">&quot;message .loopRestart&quot;</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="14" name="Log" sid="670368761444603" type="Browser">
                            <param id="0" name="Type">0</param>
                            <param id="1" name="Message">&quot;Looping&quot;</param>
                        </action>
                    </actions>
                    <sub-events>
                        <event-block sid="100574030439340">
                            <conditions>
                                <condition id="-14" name="Compare variable" sid="282965487937362" type="System">
                                    <param id="0" name="Variable">scheduledResync</param>
                                    <param id="1" name="Comparison">0</param>
                                    <param id="2" name="Value">1</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="0" name="Call function" sid="904778863188265" type="Function">
                                    <param id="0" name="Name">&quot;resync all track&quot;</param>
                                    <param id="1" name="Parameter {n}"></param>
                                </action>
                                <action id="-9" name="Set value" sid="777888649639620" type="System">
                                    <param id="0" name="Variable">scheduledResync</param>
                                    <param id="1" name="Value">0</param>
                                </action>
                            </actions>
                        </event-block>
                    </sub-events>
                </event-block>
            </sub-events>
        </event-group>
        <event-group description="" sid="343329943698222" title="resync">
            <sub-events>
                <comment>Check for desync</comment>
                <comment>If a desync is found, schedule a resync</comment>
                <event-block sid="632349083874944">
                    <conditions>
                        <condition id="-6" name="Every X seconds" sid="215896907334913" type="System">
                            <param id="0" name="Interval (seconds)">1</param>
                        </condition>
                    </conditions>
                    <actions />
                    <sub-events>
                        <comment>At end of loop, if desync is greater than 0,20, resync all tracks</comment>
                        <variable constant="0" name="desyncDelta" sid="386811845415376" static="0" type="number">0</variable>
                        <variable constant="1" name="DESYNC_MAX" sid="983447204449967" static="0" type="number">5</variable>
                        <variable constant="1" name="DESYNC_MIN" sid="836005879119791" static="0" type="number">0.18</variable>
                        <event-block sid="838426903081255">
                            <conditions />
                            <actions>
                                <action id="-9" name="Set value" sid="404463718016333" type="System">
                                    <param id="0" name="Variable">desyncDelta</param>
                                    <param id="1" name="Value">Function.Call(&quot;desync delta&quot;)</param>
                                </action>
                                <action disabled="1" id="14" name="Log" sid="468983114648023" type="Browser">
                                    <param id="0" name="Type">0</param>
                                    <param id="1" name="Message">&quot;Desync: &quot; &amp; desyncDelta</param>
                                </action>
                            </actions>
                        </event-block>
                        <event-block sid="471898898823714">
                            <conditions>
                                <condition id="-8" name="Compare two values" sid="256895698631028" type="System">
                                    <param id="0" name="First value">desyncDelta</param>
                                    <param id="1" name="Comparison">4</param>
                                    <param id="2" name="Second value">DESYNC_MIN</param>
                                </condition>
                                <condition id="-8" name="Compare two values" sid="305641766237803" type="System">
                                    <param id="0" name="First value">desyncDelta</param>
                                    <param id="1" name="Comparison">2</param>
                                    <param id="2" name="Second value">DESYNC_MAX</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action disabled="1" id="0" name="Call function" sid="493925920320837" type="Function">
                                    <param id="0" name="Name">&quot;resync all track&quot;</param>
                                    <param id="1" name="Parameter {n}"></param>
                                </action>
                                <action id="0" name="Call function" sid="904552516221039" type="Function">
                                    <param id="0" name="Name">&quot;schedule&quot;</param>
                                    <param id="1" name="Parameter {n}">&quot;resync&quot;</param>
                                </action>
                            </actions>
                        </event-block>
                    </sub-events>
                </event-block>
                <event-block sid="812892243880693">
                    <conditions>
                        <condition id="0" name="On function" sid="784554178051741" type="Function">
                            <param id="0" name="Name">&quot;resync all track&quot;</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="14" name="Log" sid="631610482645733" type="Browser">
                            <param id="0" name="Type">0</param>
                            <param id="1" name="Message">&quot;Started resync&quot;</param>
                        </action>
                    </actions>
                    <sub-events>
                        <event-block sid="944464678082336">
                            <conditions>
                                <condition id="-11" name="For Each" sid="731728221789462" type="System">
                                    <param id="0" name="Object">emitter</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="23" name="Seek to" sid="847830889881632" type="Audio">
                                    <param id="0" name="Tag">emitter.audioTag</param>
                                    <param id="1" name="Position">0</param>
                                </action>
                            </actions>
                        </event-block>
                    </sub-events>
                </event-block>
                <comment>returns the difference between the earliest and latest music track</comment>
                <event-block sid="607098649649864">
                    <conditions>
                        <condition id="0" name="On function" sid="802930901335218" type="Function">
                            <param id="0" name="Name">&quot;desync delta&quot;</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action disabled="1" id="14" name="Log" sid="876422806557642" type="Browser">
                            <param id="0" name="Type">0</param>
                            <param id="1" name="Message">&quot;start&quot;</param>
                        </action>
                    </actions>
                    <sub-events>
                        <variable constant="0" name="earliest" sid="388013393614816" static="0" type="number">0</variable>
                        <variable constant="0" name="latest" sid="198608149582294" static="0" type="number">0</variable>
                        <variable constant="0" name="current" sid="422780907575408" static="0" type="number">0</variable>
                        <event-block sid="337313808656294">
                            <conditions />
                            <actions>
                                <action id="-9" name="Set value" sid="588735568448925" type="System">
                                    <param id="0" name="Variable">earliest</param>
                                    <param id="1" name="Value">Infinity</param>
                                </action>
                                <action id="-9" name="Set value" sid="391550013819152" type="System">
                                    <param id="0" name="Variable">latest</param>
                                    <param id="1" name="Value">-Infinity</param>
                                </action>
                                <action disabled="1" id="14" name="Log" sid="649673984185920" type="Browser">
                                    <param id="0" name="Type">0</param>
                                    <param id="1" name="Message">&quot;init &quot; &amp; earliest &amp; &quot; &quot; &amp; latest</param>
                                </action>
                            </actions>
                        </event-block>
                        <event-block sid="147624888276570">
                            <conditions>
                                <condition id="-11" name="For Each" sid="805357966236679" type="System">
                                    <param id="0" name="Object">emitter</param>
                                </condition>
                                <condition id="5" name="Is tag playing" sid="945012196525865" type="Audio">
                                    <param id="0" name="Tag">emitter.audioTag</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="-9" name="Set value" sid="258059766034305" type="System">
                                    <param id="0" name="Variable">current</param>
                                    <param id="1" name="Value">Audio.PlaybackTime(emitter.audioTag)</param>
                                </action>
                                <action id="-9" name="Set value" sid="505533093057433" type="System">
                                    <param id="0" name="Variable">earliest</param>
                                    <param id="1" name="Value">min(earliest, current)</param>
                                </action>
                                <action id="-9" name="Set value" sid="442334412868908" type="System">
                                    <param id="0" name="Variable">latest</param>
                                    <param id="1" name="Value">max(latest,current)</param>
                                </action>
                                <action disabled="1" id="14" name="Log" sid="591673606155418" type="Browser">
                                    <param id="0" name="Type">0</param>
                                    <param id="1" name="Message">&quot;for each &quot; &amp; earliest &amp; &quot; &quot; &amp; latest &amp; &quot; (id &quot; &amp; emitter.IID &amp; &quot;)&quot;</param>
                                </action>
                            </actions>
                        </event-block>
                        <variable constant="0" name="return" sid="489041880000062" static="0" type="number">0</variable>
                        <event-block sid="972815567176632">
                            <conditions />
                            <actions>
                                <action id="-9" name="Set value" sid="937203805354521" type="System">
                                    <param id="0" name="Variable">return</param>
                                    <param id="1" name="Value">latest-earliest</param>
                                </action>
                                <action disabled="1" id="14" name="Log" sid="730423022191167" type="Browser">
                                    <param id="0" name="Type">0</param>
                                    <param id="1" name="Message">&quot;earliest &quot; &amp; earliest</param>
                                </action>
                                <action disabled="1" id="14" name="Log" sid="864561681447716" type="Browser">
                                    <param id="0" name="Type">0</param>
                                    <param id="1" name="Message">&quot;latest &quot; &amp; latest</param>
                                </action>
                                <action id="14" name="Log" sid="798100940639803" type="Browser">
                                    <param id="0" name="Type">0</param>
                                    <param id="1" name="Message">&quot;Desync=&quot; &amp; return</param>
                                </action>
                                <action id="1" name="Set return value" sid="747415157309300" type="Function">
                                    <param id="0" name="Value">return</param>
                                </action>
                            </actions>
                        </event-block>
                    </sub-events>
                </event-block>
                <comment>Detect end of loop to call function &quot;message .loopRestart&quot; </comment>
                <event-block sid="471930980753741">
                    <conditions />
                    <actions />
                    <sub-events>
                        <variable constant="0" name="lastTime" sid="976194618353361" static="1" type="number">0</variable>
                        <variable constant="0" name="currentTime" sid="391984990940914" static="0" type="number">0</variable>
                        <event-block sid="243548217846481">
                            <conditions>
                                <condition id="-7" name="Compare instance variable" sid="577262854581672" type="emitterLabel">
                                    <param id="0" name="Instance variable">level</param>
                                    <param id="1" name="Comparison">0</param>
                                    <param id="2" name="Value">currentLevel</param>
                                </condition>
                                <condition id="-7" name="Compare instance variable" sid="675645221920559" type="emitterLabel">
                                    <param id="0" name="Instance variable">section</param>
                                    <param id="1" name="Comparison">0</param>
                                    <param id="2" name="Value">currentSection</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="-9" name="Set value" sid="222032811928352" type="System">
                                    <param id="0" name="Variable">currentTime</param>
                                    <param id="1" name="Value">Audio.PlaybackTime(emitter.audioTag)</param>
                                </action>
                                <action disabled="1" id="14" name="Log" sid="790051513526523" type="Browser">
                                    <param id="0" name="Type">0</param>
                                    <param id="1" name="Message">lastTime</param>
                                </action>
                            </actions>
                        </event-block>
                        <event-block sid="131693207164104">
                            <conditions>
                                <condition id="-14" name="Compare variable" sid="421951852522548" type="System">
                                    <param id="0" name="Variable">currentTime</param>
                                    <param id="1" name="Comparison">2</param>
                                    <param id="2" name="Value">lastTime</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action disabled="1" id="-42" name="Signal" sid="972913851690581" type="System">
                                    <param id="0" name="Tag">&quot;loop restart&quot;</param>
                                </action>
                                <action id="0" name="Call function" sid="118316082005376" type="Function">
                                    <param id="0" name="Name">&quot;message .loopRestart&quot;</param>
                                    <param id="1" name="Parameter {n}"></param>
                                </action>
                            </actions>
                        </event-block>
                        <event-block sid="920733785921427">
                            <conditions />
                            <actions>
                                <action id="-9" name="Set value" sid="791701072059935" type="System">
                                    <param id="0" name="Variable">lastTime</param>
                                    <param id="1" name="Value">currentTime</param>
                                </action>
                            </actions>
                        </event-block>
                    </sub-events>
                </event-block>
            </sub-events>
        </event-group>
        <event-block sid="417438558574382">
            <conditions>
                <condition id="-8" inverted="1" name="Is boolean instance variable set" sid="445973519554411" type="emitter">
                    <param id="0" name="Instance variable">active</param>
                </condition>
            </conditions>
            <actions>
                <action id="-2" name="Set Y" sid="808773242930784" type="emitter">
                    <param id="0" name="Y">player.Y + 250</param>
                </action>
            </actions>
        </event-block>
        <event-group description="" sid="145446040010363" title="Debug">
            <sub-events>
                <event-block sid="202487442024719">
                    <conditions>
                        <condition id="-18" name="Is in preview" sid="350555465556416" type="System" />
                    </conditions>
                    <actions />
                    <sub-events>
                        <variable comment="0=false" constant="0" name="covering" sid="324683458552144" static="1" type="number">0</variable>
                        <event-block sid="705878390130902">
                            <conditions>
                                <condition id="0" name="On key pressed" sid="304042302266452" type="Keyboard">
                                    <param id="0" name="Key">72 (H)</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="-15" name="Set visible" sid="815646132544398" type="img1">
                                    <param id="0" name="Visibility">0</param>
                                </action>
                                <action id="-15" name="Set visible" sid="131538800788602" type="img2">
                                    <param id="0" name="Visibility">0</param>
                                </action>
                            </actions>
                        </event-block>
                        <event-block sid="948940738527205">
                            <conditions>
                                <condition id="0" name="On key pressed" sid="465699767220446" type="Keyboard">
                                    <param id="0" name="Key">32 (Espace)</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="0" name="Call function" sid="944663115214364" type="Function">
                                    <param id="0" name="Name">&quot;resync all track&quot;</param>
                                    <param id="1" name="Parameter {n}"></param>
                                </action>
                            </actions>
                        </event-block>
                        <event-block disabled="1" sid="474524811677836">
                            <conditions>
                                <condition id="-6" name="Every X seconds" sid="875379983964006" type="System">
                                    <param id="0" name="Interval (seconds)">1</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action id="0" name="Call function" sid="783299071387022" type="Function">
                                    <param id="0" name="Name">&quot;destroy some emitters&quot;</param>
                                    <param id="1" name="Parameter {n}">1{###}2</param>
                                </action>
                                <action id="14" name="Log" sid="876355443693015" type="Browser">
                                    <param id="0" name="Type">0</param>
                                    <param id="1" name="Message">&quot;returned : &quot; &amp; Function.ReturnValue</param>
                                </action>
                            </actions>
                        </event-block>
                    </sub-events>
                </event-block>
            </sub-events>
        </event-group>
        <event-block sid="626247830692025">
            <conditions>
                <condition id="0" name="On function" sid="503977289907699" type="Function">
                    <param id="0" name="Name">&quot;adjust picked volume&quot;</param>
                </condition>
            </conditions>
            <actions />
            <sub-events>
                <variable constant="0" name="pickedVolume" sid="830511671003270" static="0" type="number">-15</variable>
                <event-block sid="606451439589879">
                    <conditions>
                        <condition id="1" name="Is overlapping another object" sid="641456180337356" type="emitter">
                            <param id="0" name="Object">player</param>
                        </condition>
                        <condition id="-11" name="For Each" sid="651739191740405" type="System">
                            <param id="0" name="Object">emitter</param>
                        </condition>
                    </conditions>
                    <actions>
                        <action id="3" name="Set volume" sid="845261243530127" type="Audio">
                            <param id="0" name="Tag">emitter.audioTag</param>
                            <param id="1" name="dB">pickedVolume</param>
                        </action>
                    </actions>
                </event-block>
            </sub-events>
        </event-block>
        <event-group description="" sid="177256076913871" title="Useful functions">
            <sub-events>
                <comment>Returns the number of sections for a level.</comment>
                <event-block sid="837407554257696">
                    <conditions>
                        <condition id="0" name="On function" sid="555918568720989" type="Function">
                            <param id="0" name="Name">&quot;max sections&quot;</param>
                        </condition>
                    </conditions>
                    <actions />
                    <sub-events>
                        <variable constant="0" name="level" sid="674719260788188" static="0" type="number">0</variable>
                        <event-block sid="441545282435225">
                            <conditions />
                            <actions>
                                <action id="-9" name="Set value" sid="256794845283207" type="System">
                                    <param id="0" name="Variable">level</param>
                                    <param id="1" name="Value">Function.Param(0)</param>
                                </action>
                            </actions>
                        </event-block>
                        <event-block sid="350581530332964">
                            <conditions>
                                <condition id="-7" name="Compare instance variable" sid="421855399873427" type="emitterLabel">
                                    <param id="0" name="Instance variable">level</param>
                                    <param id="1" name="Comparison">0</param>
                                    <param id="2" name="Value">level</param>
                                </condition>
                                <condition id="-20" name="Pick highest/lowest" sid="189131087485804" type="emitterLabel">
                                    <param id="0" name="Which">1</param>
                                    <param id="1" name="Instance variable">section</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action disabled="1" id="14" name="Log" sid="637875295210441" type="Browser">
                                    <param id="0" name="Type">0</param>
                                    <param id="1" name="Message">&quot;max section = &quot; &amp; emitterLabel.section</param>
                                </action>
                                <action id="1" name="Set return value" sid="521798872977826" type="Function">
                                    <param id="0" name="Value">emitterLabel.section</param>
                                </action>
                            </actions>
                        </event-block>
                        <event-block sid="721623922702540">
                            <conditions>
                                <condition id="-22" name="Else" sid="505016287374651" type="System" />
                            </conditions>
                            <actions>
                                <action id="1" name="Set return value" sid="661820373622281" type="Function">
                                    <param id="0" name="Value">0</param>
                                </action>
                            </actions>
                        </event-block>
                    </sub-events>
                </event-block>
                <comment>Returns the number of instrument in a section.</comment>
                <event-block sid="909371043154803">
                    <conditions>
                        <condition id="0" name="On function" sid="908703787107036" type="Function">
                            <param id="0" name="Name">&quot;max instruments&quot;</param>
                        </condition>
                    </conditions>
                    <actions />
                    <sub-events>
                        <variable constant="0" name="level" sid="682156630740982" static="0" type="number">0</variable>
                        <variable constant="0" name="section" sid="548586214657789" static="0" type="number">0</variable>
                        <event-block sid="154480958223997">
                            <conditions />
                            <actions>
                                <action id="-9" name="Set value" sid="926030236907887" type="System">
                                    <param id="0" name="Variable">level</param>
                                    <param id="1" name="Value">Function.Param(0)</param>
                                </action>
                                <action id="-9" name="Set value" sid="561140347372591" type="System">
                                    <param id="0" name="Variable">section</param>
                                    <param id="1" name="Value">Function.Param(1)</param>
                                </action>
                            </actions>
                        </event-block>
                        <event-block sid="906419405001058">
                            <conditions>
                                <condition id="-7" name="Compare instance variable" sid="184855945399653" type="emitterLabel">
                                    <param id="0" name="Instance variable">level</param>
                                    <param id="1" name="Comparison">0</param>
                                    <param id="2" name="Value">level</param>
                                </condition>
                                <condition id="-7" name="Compare instance variable" sid="187791399635216" type="emitterLabel">
                                    <param id="0" name="Instance variable">section</param>
                                    <param id="1" name="Comparison">0</param>
                                    <param id="2" name="Value">section</param>
                                </condition>
                                <condition id="-20" name="Pick highest/lowest" sid="123186576082156" type="emitterLabel">
                                    <param id="0" name="Which">1</param>
                                    <param id="1" name="Instance variable">instrument</param>
                                </condition>
                            </conditions>
                            <actions>
                                <action disabled="1" id="14" name="Log" sid="736534531316914" type="Browser">
                                    <param id="0" name="Type">0</param>
                                    <param id="1" name="Message">&quot;max instrument = &quot; &amp; emitterLabel.instrument</param>
                                </action>
                                <action id="1" name="Set return value" sid="238637879173515" type="Function">
                                    <param id="0" name="Value">emitterLabel.instrument</param>
                                </action>
                            </actions>
                        </event-block>
                        <event-block sid="144332896796870">
                            <conditions>
                                <condition id="-22" name="Else" sid="663807283932864" type="System" />
                            </conditions>
                            <actions>
                                <action id="1" name="Set return value" sid="144741749505035" type="Function">
                                    <param id="0" name="Value">0</param>
                                </action>
                            </actions>
                        </event-block>
                    </sub-events>
                </event-block>
            </sub-events>
        </event-group>
    </events>
</c2eventsheet>
